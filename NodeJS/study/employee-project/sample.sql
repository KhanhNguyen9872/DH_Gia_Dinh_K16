CREATE DATABASE sampledb CHARACTER SET utf8 COLLATE utf8_general_ci;

USE sampledb;

CREATE TABLE DEPARTMENT (
   DEPT_ID INTEGER NOT NULL,
   DEPT_NAME VARCHAR(255) NOT NULL,
   DEPT_NO VARCHAR(20) NOT NULL,
   LOCATION VARCHAR(255),
   PRIMARY KEY (DEPT_ID),
   UNIQUE (DEPT_NO)
);
 
CREATE TABLE EMPLOYEE (
   EMP_ID BIGINT NOT NULL,
   EMP_NAME VARCHAR(50) NOT NULL,
   EMP_NO VARCHAR(20) NOT NULL,
   HIRE_DATE DATE NOT NULL,
   IMAGE LONGBLOB,
   JOB VARCHAR(30) NOT NULL,
   SALARY FLOAT NOT NULL,
   DEPT_ID INTEGER NOT NULL,
   MNG_ID BIGINT,
   PRIMARY KEY (EMP_ID),
   UNIQUE (EMP_NO)
);
 
CREATE TABLE SALARY_GRADE (
   GRADE INTEGER NOT NULL,
   HIGH_SALARY FLOAT NOT NULL,
   LOW_SALARY FLOAT NOT NULL,
   PRIMARY KEY (GRADE)
);
 
CREATE TABLE TIMEKEEPER (
   Timekeeper_Id VARCHAR(36) NOT NULL,
   Date_Time DATETIME NOT NULL,
   In_Out CHAR(1) NOT NULL,
   EMP_ID BIGINT NOT NULL,
   PRIMARY KEY (Timekeeper_Id)
);
 
 CREATE TABLE `USER` (
  USER_ID BIGINT NOT NULL AUTO_INCREMENT,
  USERNAME VARCHAR(50) NOT NULL,
  PASSWORD VARCHAR(255) NOT NULL,
  EMAIL VARCHAR(100),
  CREATED_AT DATETIME DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (USER_ID),
  UNIQUE (USERNAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;
 
ALTER TABLE EMPLOYEE
   ADD INDEX FK75C8D6AE269A3C9 (DEPT_ID),
   ADD CONSTRAINT FK75C8D6AE269A3C9
   FOREIGN KEY (DEPT_ID)
   REFERENCES DEPARTMENT (DEPT_ID);
 
ALTER TABLE EMPLOYEE
   ADD INDEX FK75C8D6AE13C12F64 (MNG_ID),
   ADD CONSTRAINT FK75C8D6AE13C12F64
   FOREIGN KEY (MNG_ID)
   REFERENCES EMPLOYEE (EMP_ID);
 
ALTER TABLE TIMEKEEPER
   ADD INDEX FK744D9BFF6106A42 (EMP_ID),
   ADD CONSTRAINT FK744D9BFF6106A42
   FOREIGN KEY (EMP_ID)
   REFERENCES EMPLOYEE (EMP_ID);
   
-- Chèn dữ liệu mẫu cho bảng DEPARTMENT
INSERT INTO DEPARTMENT (DEPT_ID, DEPT_NAME, DEPT_NO, LOCATION) VALUES
(1, 'Human Resources', 'HR001', 'New York'),
(2, 'Finance', 'FIN001', 'Los Angeles'),
(3, 'Engineering', 'ENG001', 'San Francisco');

-- Chèn dữ liệu mẫu cho bảng EMPLOYEE
-- Lưu ý: Mỗi nhân viên thuộc một phòng ban (DEPT_ID) và có thể có MNG_ID (manager) nếu là nhân viên dưới quyền
INSERT INTO EMPLOYEE (EMP_ID, EMP_NAME, EMP_NO, HIRE_DATE, JOB, SALARY, DEPT_ID, MNG_ID) VALUES
(1, 'Alice Smith', 'E001', '2020-01-15', 'Manager', 80000, 1, NULL),
(2, 'Bob Johnson', 'E002', '2020-02-01', 'HR Specialist', 50000, 1, 1),
(3, 'Carol Williams', 'E003', '2019-11-20', 'Manager', 85000, 2, NULL),
(4, 'David Brown', 'E004', '2020-03-05', 'Accountant', 55000, 2, 3),
(5, 'Eve Davis', 'E005', '2018-09-10', 'Director', 120000, 3, NULL),
(6, 'Frank Miller', 'E006', '2021-06-15', 'Engineer', 70000, 3, 5);

-- Chèn dữ liệu mẫu cho bảng SALARY_GRADE
-- Ví dụ: 5 cấp bậc lương với khoảng dưới và trên
INSERT INTO SALARY_GRADE (GRADE, HIGH_SALARY, LOW_SALARY) VALUES
(1, 30000, 0),
(2, 60000, 30001),
(3, 90000, 60001),
(4, 120000, 90001),
(5, 150000, 120001);

-- Chèn dữ liệu mẫu cho bảng TIMEKEEPER
-- Sử dụng một chuỗi UUID mẫu cho cột Timekeeper_Id (định dạng 36 ký tự)
INSERT INTO TIMEKEEPER (Timekeeper_Id, Date_Time, In_Out, EMP_ID) VALUES
('00000000-0000-0000-0000-000000000001', '2023-02-15 08:00:00', 'I', 2),
('00000000-0000-0000-0000-000000000002', '2023-02-15 12:00:00', 'O', 2),
('00000000-0000-0000-0000-000000000003', '2023-02-15 08:05:00', 'I', 4);

-- Chèn dữ liệu mẫu cho bảng USER (dành cho phần đăng nhập)
-- Lưu ý: Trong môi trường thực tế, mật khẩu nên được lưu ở dạng băm (hashed)
INSERT INTO `USER` (USERNAME, PASSWORD, EMAIL) VALUES
('admin', 'admin', 'admin@example.com'),
('user', 'user', 'john.doe@example.com');
   